$(function(){
	$("#header").load("header.html",function(){
		$("#header .nav-top .mysp").mouseover(function(){
		$(".mysp span").css("background","url(img/top-ss.jpg) no-repeat")
		$(".mysp-li").css({"display":"block"})
		$(".mysp-li").mouseover(function(){
			$(".mysp-li").css({"display":"block"})
		})
		
	})
	$("#header .nav-top .nav-mysp").mouseout(function(){
		$(".mysp span").css("background","url(img/top-s.jpg) no-repeat")
		$(".mysp-li").css("display","none")
	})
	$("#header .nav-top .app").mouseover(function(){
		$(".app span").css("background","url(img/top-ss.jpg) no-repeat")
		$(".app-li").css("display","block")
		$(".app-li").mouseover(function(){
			$(".app-li").css({"display":"block"})
		})
	})
	$("#header .nav-top .my-app").mouseout(function(){
		$(".app span").css("background","url(img/top-s.jpg) no-repeat")
		$(".app-li").css("display","none")
		
	})
	$("#header .nav-top .cont").mouseover(function(){
		$(".cont span").css("background","url(img/top-ss.jpg) no-repeat")
		$(".cont-li").css("display","block")
		$(".cont-li").mouseover(function(){
			$(".cont-li").css({"display":"block"})
		})
	})
	$("#header .nav-top .my-cont").mouseout(function(){
		$(".cont span").css("background","url(img/top-s.jpg) no-repeat")
		$(".cont-li").css("display","none")
	})
	
	$(".login-f1 .a1").on("click",function(){
			window.location.href = "login.html";
		})
		$(".login-f1 .a2").click(function(){
			window.location.href = "login.html";
		})
		
		//登录成功后改变提示信息
		if(getCookie("a")){                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
			$(".login-f1").html("Hi! <a href='#'>"+getCookie("name")+"</a>欢迎来到速普商城!" + " [  <a href='javascript:;' class='a3' >退                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            出</a> ] 未读消息 [ <a href='javascript:;' class='a4' >1</a> ]")
		}
		//退出
		$(".a3").click(function(){
			$(".login-f1").html("欢迎来到速普商城！ 请 [<a href='javascript:;' class='a1' >登录</a> ]  [<a href='javascript:;' class='a2' >免费注册</a> ]")
			if(getCookie("123")){
				$(".reg-bn1").css({"display":"block"})
				$(".reg-bn").css({"display":"none","right":"0px"})
				$(".reg-bn1").animate({"right":"100px"},1000,function(){
					$(".reg").html("欢迎登录")
				})
				window.location.href = "login.html"
			}
		})
	
		//三级菜单
		//鼠标移入
		$(".menu-nav dl .lt").mouseenter(function(){
			$(".menu-nav").css({"border":"2px solid #E5004B","border-top": "0","border-left":"0","height":"447px"})
			$(this).css({"background":"#fff","color":"#E5004B"}).next().show().parents("dl").siblings().children(".menu-nav dl .rt").hide()
			$(this).next(".rt").mouseenter(function(){
				$(".rt").css("display","block")
				$(".menu-nav").css({"border":"2px solid #E5004B","border-top": "0","border-left":"0","height":"447px"})
				$(this).siblings(".lt").css({"background":"#fff","color":"#E5004B"}).parents("dl").siblings().children(".menu-nav dl .rt").hide()
				$(this).siblings(".lt").children("span").css("background-position-x","-35px")
			})
			$(this).next(".rt").css("z-index","1000")
			$(this).children("span").css("background-position-x","-35px")
			
		})
		//鼠标移出
		$(".menu-nav dl .lt").mouseleave(function(){	
			$(this).css({"background":"#E5004B  url(img/menu-gt.jpg) no-repeat 190px","color":"#fff"}).next().hide()
			$(this).children("span").css("background-position-x","0")
			$(".menu-nav").css({"border":"0","height":"449px"})
			$(this).next(".rt").mouseleave(function(){
				$(".rt").css("display","none")
				$(this).siblings(".lt").css({"background":"#E5004B  url(img/menu-gt.jpg) no-repeat 190px","color":"#fff"}).next().hide()
				$(this).siblings(".lt").children("span").css("background-position-x","0")
				$(".menu-nav").css({"border":"0","height":"449px"})
			})
			$(this).next(".rt").css("z-index","1")
		})
		$(".menu span").mouseenter(function(){
			$(".menu-nav").css({"display":"block","z-index":"1"})
		})
		$(".menu-nav").mouseleave(function(){
			$(".menu-nav").css({"display":"none","z-index":"0"})
		})
	})
	
	//放大镜
	
	$(".left_bott ul li").mouseenter(function(){
		var index = $(this).index()
		//console.log(index)
		$(this).css({"border":"2px solid #e5004B"}).siblings().css({"border":"1px solid #ccc"})
		
//		var $t = $(this).parents(".left_bott").siblings(".left_top").children("ul").children("li")
//		var $t1 = $(this).parents(".left_bott").siblings(".left_top").children(".big_pic").children("ul").children("li")
//		$t.eq(index).css("display","block").siblings().css("display","none")
//		$t1.eq(index).css("display","block").siblings().css("display","none")
	
	var smallarr = ["img/14643201621643956.jpg!480.jpg","img/14643201641642912.jpg!480.jpg","img/14643201661647911.jpg!480.jpg","img/14643201731642777.jpg!480.jpg","img/14643201751648840.jpg!480.jpg"]
	$(".left_top ul li img").attr("src",smallarr[index])
	var bigarr = ["img/14643201621643956.jpg!480!.jpg","img/14643201641642912.jpg!480!.jpg","img/14643201661647911.jpg!480!.jpg","img/14643201731642777.jpg!480!.jpg","img/14643201751648840.jpg!480!.jpg"]
	$(".big_pic ul li img").attr("src",bigarr[index])
	})								

var oDiv = document.getElementsByClassName('lc_top2')[0];
			var smallPic = document.getElementsByClassName('left_top')[0];
//			var smallPic = oDiv1.getElementsByTagName('ul')[0];
			var move = document.getElementsByClassName('small_pic')[0];
			var bigPic = document.getElementsByClassName('big_pic')[0];
			var bigImg = bigPic.getElementsByTagName('img')[0];
			
			smallPic.onmouseover = function(){
				move.style.display = 'block';
				bigPic.style.display = 'block';
			};
			smallPic.onmouseout = function(){
				move.style.display = 'none';
				bigPic.style.display = 'none';
			};
			document.onmousemove = function(evt){
				var e = evt || window.event;
				var l = e.pageX - smallPic.offsetLeft -(move.offsetWidth/2) ;
				var t = e.pageY  - smallPic.offsetTop - (move.offsetHeight/2) ;
				if(l < 0){
					l = 0;
				}else if(l > smallPic.offsetWidth - move.offsetWidth ){
					l = smallPic.offsetWidth - move.offsetWidth;
				}
				if( t < 0){
					t = 0;
				}else if(t > smallPic.offsetHeight - move.offsetHeight ){
					t = smallPic.offsetHeight - move.offsetHeight;
				}
				move.style.left = l + 'px';
				move.style.top = t + 'px';
				//大图
				var conX = l/(smallPic.offsetWidth - move.offsetWidth);
				var conY = t/(smallPic.offsetHeight - move.offsetHeight);
				bigImg.style.left = -conX * (bigImg.offsetWidth - bigPic.offsetWidth) + 'px';
				bigImg.style.top = -conY * (bigImg.offsetHeight - bigPic.offsetHeight) + 'px';
				//document.title = bigImg.style.left+":"+bigImg.style.top
	};
	//选择样式
	$(".one1 a").click(function(){
		$(this).css("border","1px solid #ff9900").siblings().css("border","1px solid #ccc")
	})
	$(".one2 a").click(function(){
		$(this).css("border","1px solid #ff9900").siblings().css("border","1px solid #ccc")
	})
	//商品数量
	$(".leftbtn").click(function(){
		var i = $(this).next().children("input").val()
		if(i<=0){
			
		}else{
			--i
		$(this).next().children("input").val(i)
		}
		
	})
	$(".rightbtn").click(function(){
		var i = $(this).siblings("span").children("input").val()
		//console.log(i)
		++i
		//console.log(i)
		$(this).siblings("span").children("input").val(i)
	})
	
	
				var dataid = getCookie("dataid")
				//console.log(dataid)
				$.ajax({
					url:"js/data.json",
					dataType:"json",
					success:function(data){
						var	mag = data.data;
						var str = '';
						
						for(var i in mag){
							if(dataid == mag[i].id){
								
								str = '<a class="l btn" href="#" style="display: inline-block; width: 138px; height: 42px; background: #E5004A; line-height: 42px; color: #fff;text-align: center;" dataid="'+ mag[i].id + '">加入购物车</a>'
							}
						}
						$("#con .lc_top2_right .last").prepend(str)
					}
				})
				$(".last").on("click",".btn",function(){
					var dataid = $(this).attr("dataid")
					var num = $(this).parents(".last").siblings(".one3").children("dd").children("span").children("input").val()
					//alert(num)
					if(getCookie(dataid)){
						setCookie(dataid,dataid)
						var oldnum = getCookie("n"+dataid)
						var newnum = Number(oldnum)+Number(num)
						//alert(newnum)
						setCookie("n"+dataid,newnum)
						window.location.href = "add.html"
					}else{
						setCookie(dataid,dataid)
						setCookie("n"+dataid,num)
						//alert(num)
						window.location.href = "add.html"
					}
					
				})
		
	
	
})









